{"version":3,"sources":["../../src/pages/mensajes-enviar/mensajes-enviar.module.ts","../../src/pages/mensajes-enviar/mensajes-enviar.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAyC;AACO;AACO;AAUvD;IAAA;IAAuC,CAAC;IAA3B,wBAAwB;QARpC,uEAAQ,CAAC;YACR,YAAY,EAAE;gBACZ,4EAAkB;aACnB;YACD,OAAO,EAAE;gBACP,sEAAe,CAAC,QAAQ,CAAC,4EAAkB,CAAC;aAC7C;SACF,CAAC;OACW,wBAAwB,CAAG;IAAD,+BAAC;CAAA;AAAH;;;;;;;;;;;;;;;;;;;;;;;;;ACZK;AACa;AACsC;AACb;AACN;AAC3B;AACqB;AASpE;IAeE,4BAAmB,OAAsB,EAAU,UAAsB,EAAS,SAAoB,EAC7F,SAA0B,EAAS,QAAwB,EAAS,WAA8B,EAClG,WAAgC,EAAS,SAA4B,EAAS,WAAwB;QAF5F,YAAO,GAAP,OAAO,CAAe;QAAU,eAAU,GAAV,UAAU,CAAY;QAAS,cAAS,GAAT,SAAS,CAAW;QAC7F,cAAS,GAAT,SAAS,CAAiB;QAAS,aAAQ,GAAR,QAAQ,CAAgB;QAAS,gBAAW,GAAX,WAAW,CAAmB;QAClG,gBAAW,GAAX,WAAW,CAAqB;QAAS,cAAS,GAAT,SAAS,CAAmB;QAAS,gBAAW,GAAX,WAAW,CAAa;QAfhH,aAAQ,GAAQ,EAAE,CAAC;QAClB,YAAO,GAAW,gBAAgB,CAAC;QACnC,aAAQ,GAAQ,EAAE,CAAC;QACnB,SAAI,GAAQ,EAAE,CAAC;QACf,aAAQ,GAAQ,EAAE,CAAC;QACnB,WAAM,GAAQ;YACZ,KAAK,EAAE,EAAE;SACV;QACD,UAAK,GAAW,EAAE,CAAC;QAEnB,kBAAa,GAAY,KAAK,CAAC;QAO3B,IAAI,CAAC,QAAQ,GAAG,WAAW,CAAC,KAAK,CAAC;YAChC,KAAK,EAAE,CAAC,EAAE,EAAE,kEAAU,CAAC,OAAO,CAAC,CAAC,kEAAU,CAAC,QAAQ,CAAC,CAAC,CAAC;SACvD,CAAC,CAAC;IACP,CAAC;IAGD,6CAAgB,GAAhB;QAAA,iBAuBC;QAtBC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC,IAAI,CAAC,cAAI;YACpC,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;gBACT,KAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;gBACjC,KAAI,CAAC,QAAQ,CAAC,iBAAiB,CAAC,EAAE,CAAC,CAAC;gBACpC,KAAI,CAAC,IAAI,GAAG,KAAI,CAAC,QAAQ,CAAC,IAAI,CAAC;gBAC/B,KAAI,CAAC,QAAQ,GAAG,KAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC;YAEzC,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,KAAI,CAAC,OAAO,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC;YACzC,CAAC;QACH,CAAC,CAAC,CAAC;QACH,IAAI,CAAC;YACH,IAAI,CAAC,UAAU,CAAC,gBAAgB,EAAE,CAAC,IAAI,CAAC,aAAG;gBACzC,KAAI,CAAC,OAAO,GAAG,eAAe,GAAG,GAAG,CAAC;YACvC,CAAC,EACC,eAAK;gBACH,4DAA4D;gBAC5D,mBAAmB;YACrB,CAAC,CAAC,CAAC;QACP,CAAC;QAAC,KAAK,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;QAEjB,CAAC;IACH,CAAC;IAED,0CAAa,GAAb;QAAA,iBA0BC;QAzBC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;QAC1B,EAAE,EAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAC;YACtB,IAAI,CAAC,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK;YAC9B,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,aAAa,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;YACtD,IAAI,SAAO,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,EAAE,OAAO,EAAE,qBAAqB,EAAE,CAAC,CAAC;YAC1E,SAAO,CAAC,OAAO,EAAE,CAAC;YAClB,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,GAAG,EAAE,IAAI,CAAC,MAAM,CAAC;iBACnE,SAAS,CACR,UAAC,IAAI;gBACL,SAAO,CAAC,OAAO,EAAE,CAAC;gBAClB,KAAI,CAAC,SAAS,CAAC,EAAE,EAAE,2BAA2B,CAAC,CAAC;YAEpD,CAAC,EACD,UAAC,KAAK;gBACJ,SAAO,CAAC,OAAO,EAAE,CAAC;gBAClB,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;oBACR,KAAI,CAAC,SAAS,CAAC,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;gBAE5D,CAAC;gBAAC,IAAI,CAAC,CAAC;oBACN,KAAI,CAAC,SAAS,CAAC,OAAO,EAAE,qEAAqE,CAAC,CAAC;gBACjG,CAAC;YACH,CAAC,CAAC,CAAC;QACL,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,yCAAyC,CAAC,CAAC;QACrE,CAAC;IACH,CAAC;IAEH,sCAAS,GAAT,UAAU,KAAK,EAAE,QAAQ;QACvB,IAAI,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YAChC,KAAK,EAAE,KAAK;YACZ,QAAQ,EAAE,QAAQ;YAClB,OAAO,EAAE,CAAC,IAAI,CAAC;SAChB,CAAC,CAAC;QACH,KAAK,CAAC,OAAO,EAAE,CAAC;IAClB,CAAC;IAED,sCAAS,GAAT,UAAU,KAAK,EAAE,QAAQ;QAAzB,iBAeC;QAdC,IAAI,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YAChC,KAAK,EAAE,KAAK;YACZ,QAAQ,EAAE,QAAQ;YAClB,OAAO,EAAE;gBACP;oBACE,IAAI,EAAC,IAAI;oBACT,OAAO,EAAE;wBACP,KAAI,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC;oBACrB,CAAC;iBACJ;aAEA;SACF,CAAC,CAAC;QACH,KAAK,CAAC,OAAO,EAAE,CAAC;IAClB,CAAC;IAEC,mCAAM,GAAN;QACE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC;IACnC,CAAC;IA1GU,kBAAkB;QAJ9B,wEAAS,CAAC;YACT,QAAQ,EAAE,sBAAsB;WACG;SACpC,CAAC;yJAgB4B,0EAAmC,CAAuC;YAClF,iGAAkC,6FAAoC,qEAAiB;YACrF,eAAyF;OAjBpG,kBAAkB,CA4G9B;IAAD,CAAC;AAAA;SA5GY,kBAAkB,gB","file":"10.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { MensajesEnviarPage } from './mensajes-enviar';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    MensajesEnviarPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(MensajesEnviarPage),\r\n  ],\r\n})\r\nexport class MensajesEnviarPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/mensajes-enviar/mensajes-enviar.module.ts","import { Component } from '@angular/core';\r\nimport { AppVersion } from '@ionic-native/app-version';\r\nimport { IonicPage, NavController, NavParams, AlertController, LoadingController } from 'ionic-angular';\r\nimport { AriagroDataProvider } from '../../providers/ariagro-data/ariagro-data';\r\nimport { LocalDataProvider } from '../../providers/local-data/local-data';\r\nimport { ViewController } from 'ionic-angular';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\n\r\n\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-mensajes-enviar',\r\n  templateUrl: 'mensajes-enviar.html',\r\n})\r\nexport class MensajesEnviarPage {\r\n\r\n settings: any = {};\r\n  version: string = \"ARIAGRO APP V2\";\r\n  campanya: any = {};\r\n  user: any = {};\r\n  mensajes: any = [];\r\n  correo: any = {\r\n    texto: \"\"\r\n  }\r\n  texto: string = \"\";\r\n  mensForm: FormGroup;\r\n  submitAttempt: boolean = false;\r\n\r\n\r\n  constructor(public navCtrl: NavController,  public appVersion: AppVersion, public navParams: NavParams,\r\n    public alertCrtl: AlertController, public viewCtrl: ViewController, public loadingCtrl: LoadingController,\r\n    public ariagroData: AriagroDataProvider, public localData: LocalDataProvider, public formBuilder: FormBuilder) {\r\n\r\n      this.mensForm = formBuilder.group({\r\n        texto: ['', Validators.compose([Validators.required])]\r\n      });\r\n  }\r\n\r\n\r\n  ionViewWillEnter() {\r\n    this.localData.getSettings().then(data => {\r\n      if (data) {\r\n        this.settings = JSON.parse(data);\r\n        this.viewCtrl.setBackButtonText('');\r\n        this.user = this.settings.user;\r\n        this.campanya = this.settings.campanya;\r\n       \r\n      } else {\r\n        this.navCtrl.setRoot('ParametrosPage');\r\n      }\r\n    });\r\n    try {\r\n      this.appVersion.getVersionNumber().then(vrs => {\r\n        this.version = \"ARIAGRO APP V\" + vrs;\r\n      },\r\n        error => {\r\n          // NO hacemos nada, en realidad protegemos al estar en debug\r\n          // con el navegador\r\n        });\r\n    } catch (error) {\r\n\r\n    }\r\n  }\r\n\r\n  enviarMensaje(): void {\r\n    this.submitAttempt = true;\r\n    if(this.mensForm.valid){\r\n      this.correo.texto = this.texto\r\n      this.correo.asunto = \"Mensaje de \" + this.user.nombre;\r\n      let loading = this.loadingCtrl.create({ content: 'Enviando mensaje...' });\r\n      loading.present();\r\n      this.ariagroData.postCorreo(this.settings.parametros.url, this.correo)\r\n        .subscribe(\r\n          (data) =>{\r\n          loading.dismiss();\r\n          this.showExito(\"\", \"Mensaje enviado con exito\");\r\n        \r\n      },\r\n      (error) =>{\r\n        loading.dismiss();\r\n        if (error) {\r\n            this.showAlert(\"ERROR\", JSON.stringify(error, null, 4));\r\n            \r\n        } else {\r\n          this.showAlert(\"ERROR\", \"Error de conexión. Revise disponibilidad de datos y/o configuración\");\r\n        }\r\n      });\r\n    } else {\r\n      this.showAlert(\"ERROR\", \"No se puede enviar un mensaje sin texto\");\r\n    }\r\n  }\r\n\r\nshowAlert(title, subTitle): void {\r\n  let alert = this.alertCrtl.create({\r\n    title: title,\r\n    subTitle: subTitle,\r\n    buttons: ['OK'],\r\n  });\r\n  alert.present();\r\n}\r\n\r\nshowExito(title, subTitle): void {\r\n  let alert = this.alertCrtl.create({\r\n    title: title,\r\n    subTitle: subTitle,\r\n    buttons: [\r\n      {\r\n        text:'OK',\r\n        handler: () => {\r\n          this.navCtrl.pop();\r\n        }\r\n    }\r\n    \r\n    ]\r\n  });\r\n  alert.present();\r\n}\r\n\r\n  goHome(): any {\r\n    this.navCtrl.setRoot('HomePage');\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/mensajes-enviar/mensajes-enviar.ts"],"sourceRoot":""}