{"version":3,"sources":["../../src/pages/modal-datos-cambiar/modal-datos-cambiar.module.ts","../../src/pages/modal-datos-cambiar/modal-datos-cambiar.ts"],"names":[],"mappings":"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","file":"7.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { ModalDatosCambiarPage } from './modal-datos-cambiar';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    ModalDatosCambiarPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(ModalDatosCambiarPage),\r\n  ],\r\n})\r\nexport class ModalDatosCambiarPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/modal-datos-cambiar/modal-datos-cambiar.module.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, ViewController, AlertController, ModalController, LoadingController } from 'ionic-angular';\r\nimport { AriagroDataProvider } from '../../providers/ariagro-data/ariagro-data';\r\nimport { LocalDataProvider } from '../../providers/local-data/local-data';\r\n\r\n\r\n/**\r\n * Generated class for the ModalDatosCambiarPage page.\r\n *\r\n * See https://ionicframework.com/docs/components/#navigation for more info on\r\n * Ionic pages and navigation.\r\n */\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-modal-datos-cambiar',\r\n  templateUrl: 'modal-datos-cambiar.html',\r\n})\r\nexport class ModalDatosCambiarPage {\r\n  settings: any = {};\r\n  user: any = {}\r\n  userCopia: any = {\r\n    nombre: \"\",\r\n    direccion: \"\",\r\n    codPostal: \"\",\r\n    poblacion: \"\",\r\n    provincia: \"\",\r\n    telefono1: \"\",\r\n    telefono2: \"\",\r\n    email: \"\",\r\n    iban: \"\"\r\n  };\r\n\r\n  constructor(public navCtrl: NavController, public navParams: NavParams,\r\n    public alertCrtl: AlertController, public viewCtrl: ViewController,\r\n    public ariagroData: AriagroDataProvider, public localData: LocalDataProvider, public modalCtrl: ModalController, \r\n  public loadingCtrl: LoadingController) {\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    this.localData.getSettings().then(data => {\r\n      if (data) {\r\n        this.settings = JSON.parse(data);\r\n        this.viewCtrl.setBackButtonText('');\r\n        if (this.settings.user) {\r\n          this.reemplazaNull(this.settings.user);\r\n          this.user = this.settings.user;\r\n        } else {\r\n          this.navCtrl.setRoot('LoginPage');\r\n        }\r\n      } else {\r\n        this.navCtrl.setRoot('ParametrosPage');\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  reemplazaNull(user): void {\r\n    for (var propiedad in user){\r\n      console.log(propiedad,\" \",user[propiedad]);\r\n      if(user[propiedad] === null) {\r\n        user[propiedad] = \" \"\r\n      }\r\n      \r\n  }\r\n    this.user = user;\r\n    this.userCopia = JSON.parse( JSON.stringify(user));//realizamos una copia del objeto user\r\n  }\r\n\r\n  cambioDatos = function() {\r\n            var texto = \" Datos antes de la modificación \\n\";\r\n            var label;\r\n            var contador = 0;\r\n\r\n            for (var propiedad in this.user){\r\n              \r\n              if(this.user[propiedad] != this.userCopia[propiedad]) {\r\n                label = propiedad.toString();\r\n                texto += label + \": \" + this.userCopia[propiedad] + \"\\n\";\r\n                contador ++;\r\n              }\r\n            }\r\n\r\n           \r\n\r\n            texto += \" Datos después de la modificación \\n\";\r\n\r\n            for (var propiedad_dos in this.user){\r\n              \r\n              if(this.user[propiedad_dos] != this.userCopia[propiedad_dos]) {\r\n                label = propiedad_dos.toString();\r\n                texto += label + \": \" + this.user[propiedad_dos] + \"\\n\";\r\n              }\r\n            }\r\n\r\n            if(contador > 0) {\r\n              var asunto = \"Solicitud cambio de datos (\" + this.userCopia.nombre + \")\";\r\n              var correo = {\r\n                asunto: asunto,\r\n                texto: texto\r\n              }\r\n              let loading = this.loadingCtrl.create({ content: 'Enviando correo...' });\r\n              loading.present();\r\n              this.ariagroData.postCorreo(this.settings.parametros.url, correo)\r\n                .subscribe(\r\n                  (data) => {\r\n                    loading.dismiss();\r\n                    this.showExito(\"\", \"Mensaje enviado correctamente\");\r\n                  },\r\n                  (error)=>{\r\n                    loading.dismiss();\r\n                  if (error) {\r\n                    this.showAlert(\"ERROR\", JSON.stringify(error, null, 4));\r\n                  } else {\r\n                    this.showAlert(\"ERROR\", \"Error de conexión. Revise disponibilidad de datos y/o configuración\");\r\n                  }\r\n                });\r\n\r\n            } else {\r\n              this.showAlert(\"\", \"No se ha cambiado ningún dato\");\r\n            }\r\n  }\r\n  showAlert(title, subTitle): void {\r\n    let alert = this.alertCrtl.create({\r\n      title: title,\r\n      subTitle: subTitle,\r\n      buttons: ['OK'],\r\n    });\r\n    alert.present();\r\n  }\r\n    \r\n  showExito(title, subTitle): void {\r\n    let alert = this.alertCrtl.create({\r\n      title: title,\r\n      subTitle: subTitle,\r\n      buttons: [\r\n        {\r\n          text:'OK',\r\n          handler: () => {\r\n            this.navCtrl.pop();\r\n          }\r\n      }\r\n      \r\n      ]\r\n    });\r\n    alert.present();\r\n  }\r\n\r\n  dismiss(): void {\r\n    this.viewCtrl.dismiss();\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/modal-datos-cambiar/modal-datos-cambiar.ts"],"sourceRoot":""}